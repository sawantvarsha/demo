<div *ngIf="IsBackButtonEnabled" class="page-navigation" [ngClass]="">
  <app-svg-icons class="back-button" [icon]="'back-button'" [width]="'40'" [height]="'40'" [fill]="'var(--headers)'"
    (click)="fnRedirectToHomePage()"></app-svg-icons>
  <div class="page-title">Upcoming Events</div>
</div>
<div class="component">
  <div *ngIf="!IsBackButtonEnabled" class="page-title module">
    Upcoming Events
  </div>
  <div class="main-container">
    <div class="tabs-pages">
      <div class="tabs" [ngClass]="{ 'tab-active': this.selectedTab === 1 }"
        (click)="this.selectedTab = 1; fillDataOnPeriodChange('Coupon_EvtCal')">
        Coupons
      </div>
      <div class="tabs" [ngClass]="{ 'tab-active': this.selectedTab === 2 }"
        (click)="this.selectedTab = 2; fillDataOnPeriodChange('Coupon_EvtCal')">
        Maturities
      </div>
      <!--fillDataOnPeriodChange('Maturity_EvtCal')-->
      <div class="tabs" [ngClass]="{ 'tab-active': this.selectedTab === 3 }" (click)="
          this.selectedTab = 3;
          fillDataOnPeriodChange('Corporate_Action_EvtCal')
        ">
        Corporate Action
      </div>
    </div>
    <div class="browser">
      <div class="viewAlloc">
        <div style="display: flex; align-items: baseline; gap: 10px">
          <label class="matLabelText" *ngIf="!showSchedule">Select Period</label>
          <!-- <label class="matLabelText" *ngIf="showSchedule">Select Month</label> -->
          <select *ngIf="!showSchedule" style="max-width: 150px" [(ngModel)]="period"
            (change)="fillDataOnPeriodChange(eventtype)" [disabled]="!loadingComplete">
            <option id="dropDownDiv" *ngFor="let period of periods" [value]="period.value">
              {{ period.viewValue }}
            </option>
          </select>
        </div>
        <!-- <label class="container">Grid View
                    <input type="radio" checked="checked" name="radio" (click)= "showSchedule = false">
                    <span class="checkmark"></span>
                </label>
                <label class="container">Scheduler
                    <input type="radio" name="radio" (click)= "showSchedule = true" >
                    <span class="checkmark"></span>
                </label> -->
        <div style="
            display: grid;
            align-items: center;
            grid-template-columns: auto auto 1fr;
            gap: 10px;
          ">
          <label>Grid View</label>
          <label class="switch">
            <!-- <input type="checkbox" checked [(ngModel)]="isChecked"
                            (change)="isChecked ?  calendarSchedule() : showSchedule = false"> -->
            <input type="checkbox" [(ngModel)]="isChecked" (change)="toggle()" />
            <span class="slider round"></span>
          </label>
          <label>Schedule</label>
        </div>
      </div>
      <div class="mainContainer" *ngIf="!showSchedule">
        <div class="periodAndParentDiv">
          <!-- <div style="display: flex;
                    align-items: baseline; gap: 10px;">
                        <label class="matLabelText">Select Period</label>
                        
                        <select style="max-width: 150px;" [(ngModel)]="period"
                            (change)="fillDataOnPeriodChange(eventtype)" [disabled]='!loadingComplete'>
                            <option id='dropDownDiv' *ngFor="let period of periods" [value]="period.value">
                                {{period.viewValue}}
                            </option>
                        </select>
                    </div> -->
          <div style="text-align: center">
            <div *ngIf="
                (this.loadingComplete && !this.errorFlag) ||
                this.loadingComplete
              " class="inputDiv">
              <!-- <div class="pageCount">
                                Records per page &nbsp;&nbsp;
                                <input value="10" id="records" class="inputText inputText_pageCount"
                                    [(ngModel)]="recordsPerPage" type="number" (ngModelChange)='validatePageCount()'
                                    (blur)='validateNull()'
                                    onkeypress="return (event.charCode === 8 || event.charCode === 0 || event.charCode === 13) ? null : event.charCode >= 47 && event.charCode <= 57"
                                    min="0" required>
                                <div>
                                    <app-svg-icons icon="{{'xls'}}" width="{{'26px'}}" height="{{'26px'}}"
                                        (click)='exportToExcel()'></app-svg-icons>
                                </div>

                            </div> -->
            </div>
          </div>
        </div>
        <div class="contentcontainer">
          <!-- <p>{{this.errorFlag}} {{this.errorFlagCount}} {{this.currentTabIndex}}</p> -->

          <!-- <div class="loadingIcon" *ngIf="!loadingComplete">
                        <img [src]="isProd?'assets/loading_dots.gif':'../../assets/loading_dots.gif'" height="100px"
                            width="100px">
                    </div> -->
          <div *ngIf="!loadingComplete" class="loader">
            <div class="multi-ripple">
              <div></div>
              <div></div>
            </div>
          </div>
          <div *ngIf="this.errorFlag">
            <h3 class="errorMessage">No Records Found</h3>
          </div>
          <div *ngIf="this.loadingComplete && !this.errorFlag">
            <!-- Normal Table -->
            <table #TABLE #table id="BondsTable" class="recordsTable">
              <thead>
                <tr>
                  <th class="maxwidth40">Event Date</th>
                  <th class="maxwidth40">ISIN</th>
                  <th class="minwidth70">Product</th>
                  <th class="minwidth70">Issuer</th>
                  <th class="maxwidth30">Processing Status</th>
                  <!-- <th *ngFor="let header of tabHeader">{{header}}</th> -->
                  <!-- <th class="maxwidth100">Ref No.</th>
                                    <th>ISIN</th>
                                    <th class="minwidth600">Product</th>
                                    <th>Event Date</th>
                                    <th>Event Name</th>
                                    <th>Issuer</th>
                                    <th>Status</th> -->
                </tr>
              </thead>

              <tbody *ngIf="eventtype !== 'Corporate_Action_EvtCal'">
                <tr *ngFor="
                    let i = index;
                    let data;
                    of: filteredData
                      | eventSearchPipe: searchText
                      | paginate
                        : { itemsPerPage: recordsPerPage, currentPage: p }
                  ">
                  <td class="center maxwidth40 vertical-align">
                    {{ data.RS_Schedule_Date | date: "dd-MMM-yyyy" }}
                  </td>

                  <td class="left maxwidth40 vertical-align">
                    {{ data.strategy_code }}
                  </td>

                  <td class="minwidth70 left vertical-align">
                    {{ data.Product_Name }}
                  </td>

                  <td class="left minwidth70 vertical-align">
                    {{ data.Issuer }}
                  </td>
                  <td class="center maxwidth30 vertical-align" *ngIf="data.RS_Status !== ''">
                    {{ data.RS_Status }}
                  </td>
                  <td class="center maxwidth30 vertical-align" *ngIf="data.RS_Status === ''">
                    Pending
                  </td>
                  <!-- <td class="center maxwidth100">
                                        {{data.PrdID}}
                                    </td>
                                    <td class="center dateTD">
                                        {{data.strategy_code}}
                                    </td>

                                    <td>
                                        {{data.Product_Name}}
                                    </td>

                                    <td class="dateTD" style="text-align: center;">
                                        {{data.RS_Schedule_Date | date:'dd-MMM-yyyy'}}
                                    </td>
                                    <td class="dateTD">
                                        {{data.Event_Name}}
                                    </td>
                                    <td class="dateTD">
                                        {{data.Issuer}}
                                    </td>
                                    <td class="dateTD" *ngIf="data.RS_Status !== ''">
                                        {{data.RS_Status}}
                                    </td>
                                    <td class="dateTD" *ngIf="data.RS_Status === ''">
                                        Pending
                                    </td> -->
                </tr>
              </tbody>

              <tbody *ngIf="eventtype === 'Corporate_Action_EvtCal'">
                <tr *ngFor="
                    let i = index;
                    let data;
                    of: corporateactions
                      | eventSearchPipe: searchText
                      | paginate
                        : { itemsPerPage: recordsPerPage, currentPage: p }
                  ">
                  <td class="center maxwidth40 vertical-align">
                    {{ data.Record_Date | date: "dd-MMM-yyyy" }}
                  </td>

                  <td class="left maxwidth40 vertical-align">
                    {{ data.Asset }}
                  </td>

                  <td class="minwidth70 left vertical-align">
                    {{ data.Product_Name }}
                  </td>

                  <td class="left minwidth70 vertical-align"></td>
                  <td class="center maxwidth30 vertical-align" *ngIf="data.RS_Status !== ''">
                    {{ data.RS_Status }}
                  </td>
                  <td class="center maxwidth30 vertical-align" *ngIf="data.RS_Status === ''">
                    Pending
                  </td>
                </tr>
              </tbody>
            </table>
            <div class="pagination">
              <pagination-controls *ngIf="this.loadingComplete && !this.errorFlag" (pageChange)="p = $event"
                class="pageFont">
              </pagination-controls>
            </div>

            <!-- Inverted Table -->
          </div>
        </div>
      </div>
      <!-- Added by Rohit T 04-Feb-2022 -->
      <div class="mainContainer" style="display: flex; flex-direction: column" *ngIf="showSchedule">
        <div class="event-grid">
          <div style="display: flex; flex-direction: column; gap: 20px">
            <div>
              <label>{{errorMsg}}</label>
              <label (click)="clearFilter()" style="float: right" class="links">Clear Filter(s)</label>
            </div>

            <div class="calendar-grid-outer">
              <div class="year-slider">
                <button (click)="slideRight()" id="slideRight" type="button">
                  <app-svg-icons class="" [icon]="'arrow-left-icon'" [width]="'16'" [height]="'16'">
                  </app-svg-icons>
                </button>
                <div id="container">
                  <div id="content">
                    <!-- <div class="calendar-matrix-list"> -->
                    <div (click)="getYear(year.title)" [ngClass]="{ active: year.title === currentyear }"
                      class="year-calendar" *ngFor="let year of yearRange; let i = index">
                      <label>{{ year.title }} ( {{ year.value }} )</label>
                      <!-- </div> -->
                    </div>
                  </div>
                </div>

                <button (click)="slideLeft()" id="slideLeft" type="button">
                  <app-svg-icons style="float: right" class="" [icon]="'arrow-right-icon'" [width]="'16'"
                    [height]="'16'">
                  </app-svg-icons>
                </button>
              </div>
              <!-- <div class="flex-column" style="grid-row: 1 / span 2; border-right: 1px solid var(--btn-border);">
                                <div class="calendar-matrix-list">
                                    <div (click)="getYear(year.title)" [ngClass]="{'active': year.title === currentyear }" class="year-calendar"
                                        *ngFor="let year of yearRange; let i = index">
                                        <label>{{year.title}} ( {{year.value}} )</label>
                                    </div>
                                </div>
                            </div> -->
              <!-- <div class="calendar-title">
                                <label>{{currentyear}}</label>
                            </div> -->
              <div class="flex-col month-box">
                <div class="calendar-matrix">
                  <div (click)="getMonth(month.title, i)" [ngClass]="{
                      active: month.title === currentmonth,
                      'no-pointer': month.value === 0
                    }" class="month-calendar" *ngFor="let month of MonthsCount; let i = index">
                    <label [ngClass]="{ disabled: month.value === 0 }">{{
                      month.title
                      }}</label>
                    <label [ngClass]="{ disabled: month.value === 0 }" class="event-count">{{ month.value }}</label>
                    <!-- <label [ngClass]="{'disabled': month.value === 1 }" class="event-count">{{month.value}} Event</label>
                                        <label [ngClass]="{'disabled': month.value > 1  }" class="event-count">{{month.value}} Events</label> -->
                  </div>
                </div>
              </div>
            </div>
            <div class="week-grid" *ngIf="currentmonth !== null">
              <label style="font-weight: 500; font-size: 15px; margin-bottom: 5px">{{ currentmonth }} {{ currentyear
                }}</label>
              <div class="week-header">
                <label *ngFor="let item of WEEKDAYS">{{ item }}</label>
              </div>
              <div class="week-data">
                <div *ngFor="let item of no_of_days">
                  <div class="week-class" [ngClass]="{ active: events_in_month.includes(item) }">
                    <label *ngIf="item === 0"></label>
                    <label *ngIf="item !== 0">{{ item }}</label>
                  </div>
                </div>
              </div>
            </div>
            <!-- <label>Select Year:</label> -->

            <!-- <label *ngIf="currentyear !== null">Select Month:</label> -->
          </div>
          <div style="display: flex; flex-direction: column">
            <label *ngIf="currentyear !== null || currentmonth !== null" class="box-header">Events - {{ currentmonth }}
              {{ currentyear }}</label>
            <label *ngIf="currentyear === null && currentmonth === null" class="box-header">Events - All</label>
            <div class="table-header-schedule">
              <label>Event Date</label>
              <label>Product</label>
              <!-- <label>Issuer</label> -->
              <label style="">Processing Status</label>
            </div>
            <div class="schedule-height" *ngIf="
                filteredData.length !== 0 &&
                eventtype !== 'Corporate_Action_EvtCal'
              ">
              <div class="graph-div" *ngFor="let i = index; let data; of: filteredData">
                <div class="graph-item">
                  <div class="graph-date">
                    <label>{{
                      data.RS_Schedule_Date | date: "dd-MMM-yyyy"
                      }}</label>
                  </div>
                  <div class="graph-item-list">
                    <div class="graph-item-content">
                      <label>{{ data.strategy_code }}</label>
                      <label class="amount">{{ data.Product_Name }}</label>
                    </div>
                    <div class="graph-item-content" *ngIf="data.RS_Status !== ''">
                      <label>{{ data.RS_Status }}</label>
                    </div>
                    <div class="graph-item-content" *ngIf="data.RS_Status === ''">
                      <label>Pending</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="schedule-height" *ngIf="
                filteredData.length !== 0 &&
                eventtype === 'Corporate_Action_EvtCal'
              ">
              <div class="graph-div" *ngFor="let i = index; let data; of: filteredData">
                <div class="graph-item">
                  <div class="graph-date">
                    <label>{{ data.Record_Date | date: "dd-MMM-yyyy" }}</label>
                  </div>
                  <div class="graph-item-list">
                    <div class="graph-item-content">
                      <label>{{ data.Asset }}</label>
                      <label class="amount">{{ data.Product_Name }}</label>
                    </div>
                    <!-- <div class="graph-item-content">
                      <label>{{ data.Issuer }}</label>
                    </div> -->
                    <div class="graph-item-content" *ngIf="data.RS_Status !== ''">
                      <label>{{ data.RS_Status }}</label>
                    </div>
                    <div class="graph-item-content" *ngIf="data.RS_Status === ''">
                      <label>Pending</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="schedule-height empty" *ngIf="filteredData.length === 0">
              <div class="empty-state">
                <app-svg-icons class="" [icon]="'no-records'" [width]="'100'" [height]="'100'">
                </app-svg-icons>
                <label class="state-big">No Records Found</label>
                <label class="state-small">Try to adjust your filter to find what you are looking
                  for.</label>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- <div class="pagination">
                <pagination-controls *ngIf="this.loadingComplete && !this.errorFlag " (pageChange)="p = $event"
                    class="pageFont">
                </pagination-controls>
            </div> -->
    </div>
  </div>
  <!-- <div class="pagination">
        <pagination-controls *ngIf="this.loadingComplete && !this.errorFlag " (pageChange)="p = $event"
            class="pageFont">
        </pagination-controls>
    </div> -->
</div>